<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Linux-Ansible的简介与安装-湫日 | Me•博客</title><meta name="author" content="Mec"><meta name="copyright" content="Mec"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="ansible常用命令模块1234567891011121314ansible命令的常用模块使用-ad-hoc模式-批量操作实战comman&#x2F;shell模块	   远程执行命令或脚本模块copy				模块发送文件到远程主机模块yum					模块远程安装软件(相当于到远端机器执行yum -y install xxx)service				模块远程管理服务启停模块script模块本地编写脚本，到远">
<meta property="og:type" content="article">
<meta property="og:title" content="Linux-Ansible的简介与安装-湫日">
<meta property="og:url" content="http://example.com/2023/08/24/Ansible%E7%9A%84%E4%BB%8B%E7%BB%8D%E4%B8%8E%E5%AE%89%E8%A3%85/index.html">
<meta property="og:site_name" content="Me•博客">
<meta property="og:description" content="ansible常用命令模块1234567891011121314ansible命令的常用模块使用-ad-hoc模式-批量操作实战comman&#x2F;shell模块	   远程执行命令或脚本模块copy				模块发送文件到远程主机模块yum					模块远程安装软件(相当于到远端机器执行yum -y install xxx)service				模块远程管理服务启停模块script模块本地编写脚本，到远">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://www.extremetech.com/wp-content/uploads/2012/05/Linux-logo-without-version-number-banner-sized.jpg">
<meta property="article:published_time" content="2023-08-24T11:09:42.000Z">
<meta property="article:modified_time" content="2023-08-24T11:19:39.119Z">
<meta property="article:author" content="Mec">
<meta property="article:tag" content="Linux">
<meta property="article:tag" content="编程">
<meta property="article:tag" content="Ansible">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://www.extremetech.com/wp-content/uploads/2012/05/Linux-logo-without-version-number-banner-sized.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2023/08/24/Ansible%E7%9A%84%E4%BB%8B%E7%BB%8D%E4%B8%8E%E5%AE%89%E8%A3%85/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Linux-Ansible的简介与安装-湫日',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-08-24 19:19:39'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Me•博客" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/favicon.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">13</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">14</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">7</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://www.extremetech.com/wp-content/uploads/2012/05/Linux-logo-without-version-number-banner-sized.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="Me•博客"><span class="site-name">Me•博客</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Linux-Ansible的简介与安装-湫日</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-08-24T11:09:42.000Z" title="发表于 2023-08-24 19:09:42">2023-08-24</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-08-24T11:19:39.119Z" title="更新于 2023-08-24 19:19:39">2023-08-24</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Linux/">Linux</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%BC%96%E7%A8%8B/">编程</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Linux-Ansible的简介与安装-湫日"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="ansible常用命令模块"><a href="#ansible常用命令模块" class="headerlink" title="ansible常用命令模块"></a>ansible常用命令模块</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">ansible命令的常用模块使用-ad-hoc模式-批量操作实战</span><br><span class="line"></span><br><span class="line">comman/shell模块	   远程执行命令或脚本模块</span><br><span class="line">copy				模块发送文件到远程主机模块</span><br><span class="line">yum					模块远程安装软件(相当于到远端机器执行yum -y install xxx)</span><br><span class="line">service				模块远程管理服务启停模块script模块本地编写脚本，到远程主机执行</span><br><span class="line">file				模块远程传目录或文件，做软连接等</span><br><span class="line">group				模块远程创建和管理用户组user模块远程创建和管理用户</span><br><span class="line">cron				模块远程添加定时任务</span><br><span class="line">mount				模块远程添加挂载</span><br><span class="line">get_url				模块远程下载文件</span><br><span class="line">systemd				模块通过systemd来管理服务启停，类似systemctl start httpd</span><br><span class="line">selinux				模块远程控制selinux开启或关闭</span><br><span class="line">setup				模块主机信息模块，获取主机的信息</span><br></pre></td></tr></table></figure>

<h2 id="ansible的相关概念和使用场景"><a href="#ansible的相关概念和使用场景" class="headerlink" title="ansible的相关概念和使用场景"></a>ansible的相关概念和使用场景</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ansible是一个自动化的配置管理工具, ansible集成了丰富的模块,以及强大的功能组件,可以通过一个命令行批量完成一系列的操作。进能减少我们重复性的工作,以提高工作的效率。</span><br><span class="line"></span><br><span class="line">简单的可以理解为: ansible就是一个批量操作工具</span><br><span class="line"></span><br><span class="line">使用场景：</span><br><span class="line">比如: 批量部署服务,我们想有20台服务器,都需要安装nginx服务,用手动?如果100台呢,这种情况就体现到了ansible的作用</span><br><span class="line">又如: 批量更新配置文件,我们有30台机器,配置文件需要统一进行修改,也会用到ansible</span><br><span class="line">又如： 批量发版上线或重启服务，等等，只要需要批量操作时候都可以使用ansible</span><br></pre></td></tr></table></figure>

<h2 id="ansible的主要功能"><a href="#ansible的主要功能" class="headerlink" title="ansible的主要功能"></a>ansible的主要功能</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1).批量执行远程命令，可以对N多台主机同时进行命令的执行。</span><br><span class="line">2).批量配置软件服务,可以进行自动化的方式配置和管理服务。</span><br><span class="line">3).实现软件开发功能,jumpserver堡垒机底层就是使用ansible来实现的自动化批量管理。</span><br><span class="line">4).编排高级的IT任务, ansible的playbook是一门编程语言,可以用来描绘一套IT剧本架构,完成复杂的任务。类似shell脚本</span><br><span class="line">5),通过roles角色定义,可以定义部署某一个角色任务或某一些角色任务</span><br></pre></td></tr></table></figure>

<h2 id="ansible的特点"><a href="#ansible的特点" class="headerlink" title="ansible的特点"></a>ansible的特点</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">1).学习成本低，学习容易</span><br><span class="line">ansible不需要启动任何服务,仅需要安装对应的ansible工具即可,也不需要单独安装客户端, ssh相当于ansible的客户端不像salt既要学客户端与服务端，还需要学习客户端与服务端中间通讯协议</span><br><span class="line"></span><br><span class="line">2).操作灵活</span><br><span class="line">ansible有较多的模块,提供了丰富的功能,可根据需要灵活使用各个模块功能,playbook则提供类似于编程语言的复杂功能</span><br><span class="line"></span><br><span class="line">3).简单易用</span><br><span class="line">体现在ansible一个命令可以完成很多事情</span><br><span class="line"></span><br><span class="line">4).安全可靠</span><br><span class="line">因为ansible使用了ssh协议进行通讯,既稳定也安全;移植性高:可以将写好的playbook拷贝至任意机进行执行, tcp+ssh的方式传输</span><br><span class="line"></span><br><span class="line">5).幂等性</span><br><span class="line">一个任务执行1遍和执行n遍效果一样,不会因为重复执行带来意外情况</span><br><span class="line"></span><br><span class="line">6).需要python环境</span><br><span class="line">ansible依赖大量的python模块来实现批量管理,需要有python环境: python2.6/2.7/3.x</span><br></pre></td></tr></table></figure>

<h2 id="ansible的配置文件"><a href="#ansible的配置文件" class="headerlink" title="ansible的配置文件"></a>ansible的配置文件</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# rpm-qc ansible</span><br><span class="line">/etc/ansible/ansible.cfg		# 主配置文件</span><br><span class="line">/etc/ansible/hosts				# 主机清单文件</span><br></pre></td></tr></table></figure>

<h2 id="ansible的安装方式"><a href="#ansible的安装方式" class="headerlink" title="ansible的安装方式"></a>ansible的安装方式</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">1).rpm安装(一般使用yum安装) (推荐使用)</span><br><span class="line"># wget -O /etc/yum.repos.d/epel.repo http://mirrors.aliyun.com/repo/epel-7.repo </span><br><span class="line"># yum -y install ansible</span><br><span class="line"># 或着</span><br><span class="line"># yum install epel-release</span><br><span class="line"># yum -y install ansible</span><br><span class="line"></span><br><span class="line">2).pip安装（比较麻烦）</span><br><span class="line"># yum install python3 python3-devel python3-pip-y</span><br><span class="line"># pip3 install --upgrade pip -i https://pypi.douban.com/simple/</span><br><span class="line"># pip3 install ansible-i https://pypi.douban.com/simple/</span><br><span class="line"># /usr/local/bin/ansible --version</span><br><span class="line"></span><br><span class="line">推荐使用yum安装,因为使用ansible就是因为它的简单、方便,如果为了使用它,仅安装就大费周折,还不如不用</span><br></pre></td></tr></table></figure>

<blockquote>
<p>安装过程</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 ~]<span class="comment"># yum install epel-release		#先安装epel-release</span></span><br><span class="line">[root@node1 ~]<span class="comment"># yum -y install ansible</span></span><br><span class="line">[root@node1 ~]<span class="comment"># ansible --version</span></span><br><span class="line">ansible 2.9.27</span><br><span class="line">  config file = /etc/ansible/ansible.cfg</span><br><span class="line">  configured module search path = [u<span class="string">&#x27;/root/.ansible/plugins/modules&#x27;</span>, u<span class="string">&#x27;/usr/share/ansible/plugins/modules&#x27;</span>]</span><br><span class="line">  ansible python module location = /usr/lib/python2.7/site-packages/ansible</span><br><span class="line">  executable location = /usr/bin/ansible</span><br><span class="line">  python version = 2.7.5 (default, Aug  7 2019, 00:51:29) [GCC 4.8.5 20150623 (Red Hat 4.8.5-39)]</span><br></pre></td></tr></table></figure>

<h2 id="ansible的基本配置"><a href="#ansible的基本配置" class="headerlink" title="ansible的基本配置"></a>ansible的基本配置</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">1)管理端配置主机管理：在hosts文件中添加被管理主机的ip地址列表：</span><br><span class="line">[root@node1 ~]<span class="comment"># vim /etc/ansible/hosts</span></span><br><span class="line">[<span class="built_in">test</span>]          <span class="comment"># 添加一个组名</span></span><br><span class="line">192.168.88.162  <span class="comment"># 添加被管理的主机ip</span></span><br><span class="line">192.168.88.163  <span class="comment"># 添加被管理的主机ip</span></span><br><span class="line"></span><br><span class="line">2)修改ansible的配置文件</span><br><span class="line">[root@node1 ~]<span class="comment"># vim /etc/ansible/ansible.cfg</span></span><br><span class="line">....</span><br><span class="line">host_key_checking = False   <span class="comment">#禁用每次执行ansbile命令检查ssh key host,默认注释,开启即可</span></span><br><span class="line">							<span class="comment">#首次连接是否需要检查kev认证，建议放开注释设为False</span></span><br><span class="line">							</span><br><span class="line">log_path = /var/log/ansible.log   <span class="comment"># 开启日志记录，默认注释，开启即可</span></span><br><span class="line">accelerate_port = 5099  <span class="comment"># 加速连接端口，释放，默认注释，也可改变端口号，此处没改</span></span><br><span class="line">accelerate_multi_key = <span class="built_in">yes</span>  <span class="comment"># 多密钥释放，默认注释</span></span><br></pre></td></tr></table></figure>

<h1 id="ansible命令的常用模块使用-ad-hoc模式-批量操作实战"><a href="#ansible命令的常用模块使用-ad-hoc模式-批量操作实战" class="headerlink" title="ansible命令的常用模块使用-ad-hoc模式-批量操作实战"></a>ansible命令的常用模块使用-ad-hoc模式-批量操作实战</h1><h2 id="ansible的ad-hoc模式或命令模式简介"><a href="#ansible的ad-hoc模式或命令模式简介" class="headerlink" title="ansible的ad-hoc模式或命令模式简介"></a>ansible的ad-hoc模式或命令模式简介</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible在命今行中执行的命今,也称为ad-hoc模式,ad-hoc模式其实就是&quot;临时命今&quot;执行完即结束,不会保存用ansible命令模式批量管理主机,对复杂的不方便，需要使用playbook剧本模式。</span><br></pre></td></tr></table></figure>

<h2 id="ansible常用的模块使用-通过ad-hoc命令行使用"><a href="#ansible常用的模块使用-通过ad-hoc命令行使用" class="headerlink" title="ansible常用的模块使用-通过ad-hoc命令行使用"></a>ansible常用的模块使用-通过ad-hoc命令行使用</h2><h3 id="command或shell模块"><a href="#command或shell模块" class="headerlink" title="command或shell模块"></a>command或shell模块</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">1).<span class="built_in">command</span>或shell模块,执行远程命令,管理被管理端(ad-hoc模式,其实就是临时命令,执行完即结束,不会保存)(都是批量执行命令, shell更强大,什么都能干,如果需要一些管道等复杂命令的操作,则使用shell, <span class="built_in">command</span>完成不了, shell还能执行脚木</span><br><span class="line"></span><br><span class="line">执行远程命令：以下的<span class="built_in">command</span>也可以用shell代替</span><br><span class="line">(-m是指定模块)</span><br><span class="line">(这里的组名是指在vim /etc/ansible/hosts下添加的[<span class="built_in">test</span>]    <span class="comment"># 添加一个组名)</span></span><br><span class="line">ansible 组名 -m <span class="built_in">command</span>/shell -a <span class="string">&quot;执行的远程命令&quot;</span>  <span class="comment"># 管理单独某个模块组名下机器，执行远程机器命令</span></span><br><span class="line"><span class="comment"># 实操</span></span><br><span class="line">[root@node1 ~]<span class="comment"># ansible test -m command -a &quot;free -m&quot;  # 查询系统内存</span></span><br><span class="line">192.168.88.162 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line">              total        used        free      shared  buff/cache   available</span><br><span class="line">Mem:           3770         351        3191          15         227        3192</span><br><span class="line">Swap:          3967           0        3967</span><br><span class="line">192.168.88.163 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line">              total        used        free      shared  buff/cache   available</span><br><span class="line">Mem:           3770         184        3418          11         167        3379</span><br><span class="line">Swap:          3967           0        3967</span><br><span class="line"></span><br><span class="line"><span class="comment">######################</span></span><br><span class="line">ansible all -m <span class="built_in">command</span> -a <span class="string">&quot;执行的远程命令&quot;</span>		   <span class="comment">#管理所有模块下机器,执行远程机器命令</span></span><br><span class="line"><span class="comment">######################</span></span><br><span class="line">ansible <span class="built_in">test</span> -m <span class="built_in">command</span> -a <span class="string">&quot;ifconfig|grep ens33&quot;</span> -f 50 <span class="comment">#command执行不了，-f 50一次显示50个主机</span></span><br><span class="line">ansible test-m shell -a <span class="string">&quot;ifconfig|grep ens33&quot;</span>-f 50	<span class="comment">#shell可以执行，-f 50一次显示50个主机</span></span><br></pre></td></tr></table></figure>

<h3 id="copy模块"><a href="#copy模块" class="headerlink" title="copy模块"></a>copy模块</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">2).copy模块，批量发送文件到被管理端或向被管理端文件写内容</span><br><span class="line">copy模块下常用参数：</span><br><span class="line">src:		推送数据的源文件信息</span><br><span class="line">dest:		推送数据的目录路径</span><br><span class="line">backup:		对推送传送过去的文件,进行原文件备份,再接收新文件</span><br><span class="line">content:	直接批量在皴管理端文件中添加内容</span><br><span class="line">group:		将本地文件推送到远端，指定文件属组信息</span><br><span class="line">owner:		将本地文件推送到远端，指定文件属主信息</span><br><span class="line">mode:		将本地文件推动到远端,指定文件权限信息</span><br><span class="line"></span><br><span class="line">(1).将管理端(ansible机器)上本地文件(/tmp/a.txt)批量发送给被管理端(/tmp/目录):</span><br><span class="line">copy模块注意:所有被管理端需要安装: libselinux-python,此处为192.168.171.129和192.168.171.130上)[root@localhost ~]<span class="comment"># yum install libselinux-python -y    # 默认cent7.x已经安装,若没有安装,需要先安装该包a)批量发送文件：</span></span><br><span class="line">管理端：</span><br><span class="line">[root@node1 ~]<span class="comment"># echo 11111 &gt; /tmp/a.txt</span></span><br><span class="line">[root@node1 ~]<span class="comment"># cat /tmp/a.txt </span></span><br><span class="line">11111</span><br><span class="line">[root@node1 ~]<span class="comment"># ansible test -m copy -a &quot;src=/tmp/a.txt dest=/tmp/&quot;</span></span><br><span class="line">192.168.88.163 | CHANGED =&gt; &#123;</span><br><span class="line">    <span class="string">&quot;ansible_facts&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;discovered_interpreter_python&quot;</span>: <span class="string">&quot;/usr/bin/python&quot;</span></span><br><span class="line">    &#125;, </span><br><span class="line">    <span class="string">&quot;changed&quot;</span>: <span class="literal">true</span>, </span><br><span class="line">    <span class="string">&quot;checksum&quot;</span>: <span class="string">&quot;659f5f85766824a4290371a2abfaeb007cd0af4a&quot;</span>, </span><br><span class="line">    <span class="string">&quot;dest&quot;</span>: <span class="string">&quot;/tmp/a.txt&quot;</span>, </span><br><span class="line">    <span class="string">&quot;gid&quot;</span>: 0, </span><br><span class="line">    <span class="string">&quot;group&quot;</span>: <span class="string">&quot;root&quot;</span>, </span><br><span class="line">    <span class="string">&quot;md5sum&quot;</span>: <span class="string">&quot;fa8f294721ab3fbb37793c68ff2cf09b&quot;</span>, </span><br><span class="line">    <span class="string">&quot;mode&quot;</span>: <span class="string">&quot;0644&quot;</span>, </span><br><span class="line">    <span class="string">&quot;owner&quot;</span>: <span class="string">&quot;root&quot;</span>, </span><br><span class="line">    <span class="string">&quot;size&quot;</span>: 6, </span><br><span class="line">    <span class="string">&quot;src&quot;</span>: <span class="string">&quot;/root/.ansible/tmp/ansible-tmp-1692524423.9-3528-235526458743393/source&quot;</span>, </span><br><span class="line">    <span class="string">&quot;state&quot;</span>: <span class="string">&quot;file&quot;</span>, </span><br><span class="line">    <span class="string">&quot;uid&quot;</span>: 0</span><br><span class="line">&#125;</span><br><span class="line">192.168.88.162 | CHANGED =&gt; &#123;</span><br><span class="line">    <span class="string">&quot;ansible_facts&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;discovered_interpreter_python&quot;</span>: <span class="string">&quot;/usr/bin/python&quot;</span></span><br><span class="line">    &#125;, </span><br><span class="line">    <span class="string">&quot;changed&quot;</span>: <span class="literal">true</span>, </span><br><span class="line">    <span class="string">&quot;checksum&quot;</span>: <span class="string">&quot;659f5f85766824a4290371a2abfaeb007cd0af4a&quot;</span>, </span><br><span class="line">    <span class="string">&quot;dest&quot;</span>: <span class="string">&quot;/tmp/a.txt&quot;</span>, </span><br><span class="line">    <span class="string">&quot;gid&quot;</span>: 0, </span><br><span class="line">    <span class="string">&quot;group&quot;</span>: <span class="string">&quot;root&quot;</span>, </span><br><span class="line">    <span class="string">&quot;md5sum&quot;</span>: <span class="string">&quot;fa8f294721ab3fbb37793c68ff2cf09b&quot;</span>, </span><br><span class="line">    <span class="string">&quot;mode&quot;</span>: <span class="string">&quot;0644&quot;</span>, </span><br><span class="line">    <span class="string">&quot;owner&quot;</span>: <span class="string">&quot;root&quot;</span>, </span><br><span class="line">    <span class="string">&quot;size&quot;</span>: 6, </span><br><span class="line">    <span class="string">&quot;src&quot;</span>: <span class="string">&quot;/root/.ansible/tmp/ansible-tmp-1692524423.91-3526-156070185170456/source&quot;</span>, </span><br><span class="line">    <span class="string">&quot;state&quot;</span>: <span class="string">&quot;file&quot;</span>, </span><br><span class="line">    <span class="string">&quot;uid&quot;</span>: 0</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="yun模块"><a href="#yun模块" class="headerlink" title="yun模块"></a>yun模块</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">3).yum模块,批量安装软件(相当于到远端机器执行yum -y install xxx)</span><br><span class="line">格式: <span class="comment"># ansible test -m yum-a &quot;name=要安装的服务名state=installed&quot;</span></span><br><span class="line">例子: 如: ansible test-m yum -a <span class="string">&quot;name=httpd state=installed&quot;</span></span><br><span class="line">使用详解：</span><br><span class="line">name:指定要安装的软件包名称</span><br><span class="line">name的常用参数：即是常用软件包的名称，如：httpd, ....state:指定使用yum的方法进行安装,卸载等操作</span><br><span class="line">state的常用参数如下:</span><br><span class="line">installed,present 	安装软件包</span><br><span class="line">removed,absent 		移除软件包</span><br><span class="line">latest				安装最新软件包</span><br><span class="line">例子：</span><br><span class="line">管理端：</span><br><span class="line">[root@node1 ~]<span class="comment"># ansible test -m yum -a &quot;name=httpd state=installed&quot; #安装Apache HTTP 服务器</span></span><br><span class="line">[root@node1 ~]<span class="comment"># ansible test -m command -a &quot;systemctl start httpd&quot;  # 启动</span></span><br></pre></td></tr></table></figure>

<h3 id="service模块"><a href="#service模块" class="headerlink" title="service模块"></a>service模块</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">4).service模块,启动,停止,重启,重载服务等</span><br><span class="line">格式: <span class="comment"># ansible test-m service-a &quot;name=服务名state=stopped enabled=yes&quot;</span></span><br><span class="line">例子:如: ansible <span class="built_in">test</span> -m service-a <span class="string">&quot;name=httpd state=stopped enabled=yes&quot;</span></span><br><span class="line"></span><br><span class="line">使用详解：name：定义要启动服务的名称，参数即为各服务名</span><br><span class="line">state:指定服务状态是停止或运行,或重载等,参数如下:</span><br><span class="line">	started		启动</span><br><span class="line">	stopped		停止</span><br><span class="line">	restarted	重启</span><br><span class="line">	reloaded	重载</span><br><span class="line">enabled:是否让服务开机自启动</span><br><span class="line">例子：</span><br><span class="line">管理端：</span><br><span class="line"><span class="comment"># 启动httpd服务器，并且让其开机自启</span></span><br><span class="line">[root@node1 ~]<span class="comment"># ansible test -m service -a &quot;name=httpd state=started enabled=yes&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="script模块"><a href="#script模块" class="headerlink" title="script模块"></a>script模块</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">5).script模块,编写脚本和执行脚本(本地编写脚本,本地运行,即可等同于在远程执行)</span><br><span class="line">在本地运行模块,等同于在远程执行,不需要将脚本文件进行推送目标主机执行。</span><br><span class="line">格式： <span class="comment"># ansible test -m script -a&quot;/.../本地编写的脚本.sh&quot;</span></span><br><span class="line">例子:</span><br><span class="line">管理端：</span><br><span class="line">[root@node1 ~]<span class="comment"># cat  yum_wget.sh</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line">yum install wget</span><br><span class="line">[root@node1 ~]<span class="comment"># chmod +x yum_wget.sh</span></span><br><span class="line">[root@node1 ~]<span class="comment"># ansible tes t-m script -a&quot;/root/yum_wget.sh&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="file模块"><a href="#file模块" class="headerlink" title="file模块"></a>file模块</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">6).file模块，配置模块，远程创建目录,远程创建文件，远程做软硬链接文件</span><br><span class="line">远程创建目录：</span><br><span class="line">ansible <span class="built_in">test</span> -m file -a <span class="string">&quot;path=/tmp/shi state=directory&quot;</span></span><br><span class="line"></span><br><span class="line">远程创建文件：</span><br><span class="line">ansible <span class="built_in">test</span> -m file -a <span class="string">&quot;path=/tmp/shi.txt state=touch mode=555 owner=root group=root&quot;</span></span><br><span class="line"></span><br><span class="line">远程做软连接：</span><br><span class="line">ansible <span class="built_in">test</span> -m file-a <span class="string">&quot;src=/tmp/shi.txt path=/tmp/shi.txt_link state=link&quot;</span></span><br><span class="line"></span><br><span class="line">递归创建或更改目录权限：</span><br><span class="line"><span class="comment"># recurse=yes：递归地应用上述配置，确保所有子目录和文件都具有相同的权限和所有者。</span></span><br><span class="line">ansible <span class="built_in">test</span> -m file -a <span class="string">&quot;path=/tmp/shi state=directory owner=root group=root mode=600 recurse=yes&quot;</span> </span><br><span class="line"></span><br><span class="line">path:指定远程主机目录或文件目录</span><br><span class="line">recurse: 递归授权</span><br><span class="line">state:</span><br><span class="line">	directory: 		在远端创建目录</span><br><span class="line">	<span class="built_in">touch</span>:			在远端创建文件</span><br><span class="line">	<span class="built_in">link</span>:			<span class="built_in">link</span>或hard表示创建链接文件</span><br><span class="line">	absent:			表示删除文件或目录</span><br><span class="line">	mode:			设置文件或目录权限</span><br><span class="line">	owner:			设置文件或目录属主信息</span><br><span class="line">	group:			设置文件或目录属组信息</span><br><span class="line"></span><br><span class="line">例子：</span><br><span class="line">管理端：</span><br><span class="line"><span class="comment"># 创建shi文件夹</span></span><br><span class="line">[root@node1 ~]<span class="comment"># ansible test -m file -a &quot;path=/tmp/shi state=directory&quot;   </span></span><br><span class="line">192.168.88.163 | CHANGED =&gt; &#123;</span><br><span class="line">    <span class="string">&quot;ansible_facts&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;discovered_interpreter_python&quot;</span>: <span class="string">&quot;/usr/bin/python&quot;</span></span><br><span class="line">    &#125;, </span><br><span class="line">    <span class="string">&quot;changed&quot;</span>: <span class="literal">true</span>, </span><br><span class="line">    <span class="string">&quot;gid&quot;</span>: 0, </span><br><span class="line">    <span class="string">&quot;group&quot;</span>: <span class="string">&quot;root&quot;</span>, </span><br><span class="line">    <span class="string">&quot;mode&quot;</span>: <span class="string">&quot;0755&quot;</span>, </span><br><span class="line">    <span class="string">&quot;owner&quot;</span>: <span class="string">&quot;root&quot;</span>, </span><br><span class="line">    <span class="string">&quot;path&quot;</span>: <span class="string">&quot;/tmp/shi&quot;</span>, </span><br><span class="line">    <span class="string">&quot;size&quot;</span>: 6, </span><br><span class="line">    <span class="string">&quot;state&quot;</span>: <span class="string">&quot;directory&quot;</span>, </span><br><span class="line">    <span class="string">&quot;uid&quot;</span>: 0</span><br><span class="line">&#125;</span><br><span class="line">192.168.88.162 | CHANGED =&gt; &#123;</span><br><span class="line">    <span class="string">&quot;ansible_facts&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;discovered_interpreter_python&quot;</span>: <span class="string">&quot;/usr/bin/python&quot;</span></span><br><span class="line">    &#125;, </span><br><span class="line">    <span class="string">&quot;changed&quot;</span>: <span class="literal">true</span>, </span><br><span class="line">    <span class="string">&quot;gid&quot;</span>: 0, </span><br><span class="line">    <span class="string">&quot;group&quot;</span>: <span class="string">&quot;root&quot;</span>, </span><br><span class="line">    <span class="string">&quot;mode&quot;</span>: <span class="string">&quot;0755&quot;</span>, </span><br><span class="line">    <span class="string">&quot;owner&quot;</span>: <span class="string">&quot;root&quot;</span>, </span><br><span class="line">    <span class="string">&quot;path&quot;</span>: <span class="string">&quot;/tmp/shi&quot;</span>, </span><br><span class="line">    <span class="string">&quot;size&quot;</span>: 6, </span><br><span class="line">    <span class="string">&quot;state&quot;</span>: <span class="string">&quot;directory&quot;</span>, </span><br><span class="line">    <span class="string">&quot;uid&quot;</span>: 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="group模块"><a href="#group模块" class="headerlink" title="group模块"></a>group模块</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">7).group模块,远程创建组格式: </span><br><span class="line">ansible test-m group-a <span class="string">&quot;name=要创建的组名 gid=888 state=present&quot;</span> <span class="comment">#创建组,指定gid</span></span><br><span class="line"></span><br><span class="line">例子，如：</span><br><span class="line">[root@node1 ~]<span class="comment"># ansible test-m group -a &quot;name=shi_group gid=888 state=present&quot;</span></span><br><span class="line"></span><br><span class="line">name： 指定创建的组名</span><br><span class="line">gid: 指定组的gid</span><br><span class="line">state:表示对组的操作状态，参数如下:</span><br><span class="line">        absent:删除远端的组</span><br><span class="line">        present： 创建远端的组(默认)</span><br><span class="line"></span><br><span class="line">例子：</span><br><span class="line">管理端：</span><br><span class="line"><span class="comment"># 创建一个组</span></span><br><span class="line">[root@node1 ~]<span class="comment"># ansible test-m group-a &quot;name=shi_group gid=888 state=present&quot;</span></span><br><span class="line"></span><br><span class="line">被管理端：</span><br><span class="line"><span class="comment"># 查看是否创建成功</span></span><br><span class="line">[root@node1 ~]<span class="comment"># tail -2 /etc/group </span></span><br><span class="line">apache:x:48:</span><br><span class="line">shi_group:x:888:</span><br></pre></td></tr></table></figure>

<h3 id="user模块"><a href="#user模块" class="headerlink" title="user模块"></a>user模块</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">8).user模块,远程创建用户创建用户：不加密码：</span><br><span class="line">ansible <span class="built_in">test</span> -m user -a <span class="string">&quot;name=shi uid=88 group=shi_group shell=/sbin/nologin create_home=no state=present&quot;</span></span><br><span class="line"></span><br><span class="line">删除用户:</span><br><span class="line">ansible test-m user -a <span class="string">&quot;name=shi uid=88 group=shi_group shell=/sbin/nologin create_home=no state=absent&quot;</span></span><br><span class="line"></span><br><span class="line">创建普通用户并设置登录密码:</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;mima&#x27;</span> |openssl passwd -1 -stdin 		<span class="comment">#给指定的密码内容加密，注意需要加密，用户才能登录$1$PxrQduFH$0sqImb.R6gy80gm8qlUvco</span></span><br><span class="line"></span><br><span class="line">ansible <span class="built_in">test</span> -m user -a <span class="string">&#x27;name=shi3 password=&quot;$1$PxrQduFH$0sqImb.R6gy80gm8qlUvc0&quot; </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">name: 指定创建的用户名</span></span><br><span class="line"><span class="string">uid:指定用户的uid</span></span><br><span class="line"><span class="string">gruop:指定用户组名称</span></span><br><span class="line"><span class="string">gruops:指定附加组名称</span></span><br><span class="line"><span class="string">password: 给用户添加密码</span></span><br><span class="line"><span class="string">shell:指定用户登录shell</span></span><br><span class="line"><span class="string">create_home: 是否创建家目录</span></span><br><span class="line"><span class="string">state:表示对用户的操作状态,参数如下:</span></span><br><span class="line"><span class="string">		absent: 删除远端的组</span></span><br><span class="line"><span class="string">		present: 创建远端的组(默认)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">例子：</span></span><br><span class="line"><span class="string">管理端：</span></span><br><span class="line"><span class="string"># shell=/sbin/nologin是不允许ssh登陆</span></span><br><span class="line"><span class="string">ansible test-m user-a &quot;name=shi uid=88 group=shi-group shell=/sbin/nologin create-home=no state=present&quot; #创建不加密码</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">所有被管理端即可创建用户shi:</span></span><br><span class="line"><span class="string">[root@node1 ~]# id shi</span></span><br><span class="line"><span class="string">uid=88(shi) gid=888(shi_group) groups=888(shi_group)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">创建普通用户并设置登录密码:</span></span><br><span class="line"><span class="string">管理端：</span></span><br><span class="line"><span class="string">[root@node1 ~]# echo &#x27;</span>mima<span class="string">&#x27; |openssl passwd-1-stdin  #给指定的密码内容加密,注意需要加密,用户才能登录</span></span><br><span class="line"><span class="string">$1$PxrQduFH$0sqImb.R6gy80gm8qlUvc0</span></span><br><span class="line"><span class="string">[root@node1 ~]#ansible test -m user -a &#x27;</span>name=shi3 password=<span class="string">&quot;$1$PxrQduFH<span class="variable">$0sqImb</span>.R6gy80gm8qlUvco&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="cron模块"><a href="#cron模块" class="headerlink" title="cron模块"></a>cron模块</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">9).cron模块,远程添加定时任务 (下面:a.sh是远程机器上本地有的脚本)</span><br><span class="line">远程添加定时任务，未设置注释信息：</span><br><span class="line">ansible <span class="built_in">test</span> -m cron -a <span class="string">&quot;minute=00 hour=01 day=* month=* weekday=* job=&quot;</span>/bin/sh /root/a.sh<span class="string">&#x27; state=present&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">远程添加定时任务，并设置注释信息，防止定时任务重复：</span></span><br><span class="line"><span class="string">ansible test-m cron-a &quot;minute=00 hour=01 day=* month=* weekday=* namo=&#x27;</span>注释信息<span class="string">&quot; job=/bin/sh /root/a.sh&#x27; state=present&quot;</span></span><br><span class="line"></span><br><span class="line">远程注释定时任务：</span><br><span class="line">ansible <span class="built_in">test</span> -m cron -a <span class="string">&quot;minute=00 hour=01 day=* month=* weekday=* name=&#x27;cron1&#x27; job=&#x27;/bin/sh /root/a.sh&#x27; state=present disabled=yes&quot;</span></span><br><span class="line"></span><br><span class="line">远程删除定时任务：</span><br><span class="line">ansible <span class="built_in">test</span> -m cron -a <span class="string">&quot;minute=00 hour=01 day=* month=* weekday=* name=&#x27;cron1&#x27; job=&#x27;/bin/sh /root/a.sh&#x27; state=absent&quot;</span> </span><br><span class="line"></span><br><span class="line">例子：</span><br><span class="line">管理端：</span><br><span class="line"><span class="comment">#远程添加定时任务,未设置注释信息</span></span><br><span class="line">[root@localhost ~]<span class="comment"># ansible test-m cron-a &quot;minute=00 hour=01 day=* month=* weekday=* job=&#x27;/bin/sh /root/a.sh&#x27; state=present&quot;</span></span><br><span class="line"></span><br><span class="line">所有被管理端</span><br><span class="line">[root@localhost ~]<span class="comment"># crontab -l</span></span><br><span class="line"><span class="comment"># Ansible: None</span></span><br><span class="line">00 01 * ** /bin/sh /root/a.sh</span><br><span class="line"></span><br><span class="line">管理端</span><br><span class="line"><span class="comment">#远程添加定时任务，并设置注释信息，防止定时任务重复</span></span><br><span class="line">[root@localhost ~]<span class="comment"># ansible test-m cron-a &quot;minute=00 hour=01 day=* month=* weekday=* name=&#x27;cron1&#x27; iob=&#x27;/bin/sh /root/a.sh&#x27; state=present&quot;</span></span><br><span class="line"></span><br><span class="line">所有被管理端</span><br><span class="line">[root@localhost ~]<span class="comment"># crontab -l</span></span><br><span class="line"><span class="comment"># Ansible: cron1</span></span><br><span class="line">00 01 * ** /bin/sh /root/a.sh</span><br><span class="line"></span><br><span class="line">管理端： </span><br><span class="line"><span class="comment">#远程注释定时任务</span></span><br><span class="line">[root@localhost ~]<span class="comment"># ansible test-m cron-a &quot;minute=00 hour=01 day=*month=* weekday=* name=&#x27;cron1&#x27; job=&#x27;/bin/sh /root/a.sh&#x27; state=present disabled=yes&quot;</span></span><br><span class="line"></span><br><span class="line">所有被管理端</span><br><span class="line">[root@localhost ~]<span class="comment"># crontab -l</span></span><br><span class="line"><span class="comment"># Ansible: cron1</span></span><br><span class="line">00 01 * ** /bin/sh /root/a.sh</span><br></pre></td></tr></table></figure>

<h3 id="mount模块"><a href="#mount模块" class="headerlink" title="mount模块"></a>mount模块</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">10).mount模块，远程添加挂载</span><br><span class="line">立刻挂载并写入/etc/fstab中:</span><br><span class="line">ansible <span class="built_in">test</span> -m mount -a <span class="string">&quot;src=192.168.88.161:/data path=/opt fstype=nfs opts=defaults,noatime state=mounted&quot;</span></span><br><span class="line"></span><br><span class="line">立刻卸载并清除/etc/fstab中信息:</span><br><span class="line">ansible test-m mount -a <span class="string">&quot;src=192.168.88.161:/data path=/opt fstype=nfs opts=defaults,noatime state=absent&quot;</span></span><br><span class="line"></span><br><span class="line">src:要被挂载的原目录</span><br><span class="line">path: 要挂载到的本地目录</span><br><span class="line">fstype:要挂载的文件类型</span><br><span class="line">state： 挂载或卸载的状态，常用参数如下：</span><br><span class="line">        present:开机挂载,不会直接挂载设备,仅将配置写入/etc/fstab,不会马上挂载</span><br><span class="line">        mounted:马上直接挂载设备，并将配置写入/etc/fstab</span><br><span class="line">        unmounted:马上直接卸载设备,不会清除/etc/fstab写入的配置</span><br><span class="line">        absent:马上直接卸载设备，会清理/etc/fstab写入的配置</span><br><span class="line">        </span><br><span class="line">例子</span><br><span class="line">管理端：192.168.88.161</span><br><span class="line">[root@node1 ~]<span class="comment"># yum -y install nfs-utils    # 被管理得挂载端也要安装，才能挂载</span></span><br><span class="line">[root@node1 ~]<span class="comment"># cat /etc/exports</span></span><br><span class="line">/data *(rw,no_root_squash)</span><br><span class="line">[root@node1 ~]<span class="comment"># systemctl start nfs  # 启动nfs</span></span><br><span class="line">[root@node1 ~]<span class="comment"># ansible test -m mount -a &quot;src=192.168.88.161:/data path=/opt fstype=nfs opts=defaults,noatime state=mounted&quot;</span></span><br><span class="line">192.168.88.163 | CHANGED =&gt; &#123;</span><br><span class="line">    <span class="string">&quot;ansible_facts&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;discovered_interpreter_python&quot;</span>: <span class="string">&quot;/usr/bin/python&quot;</span></span><br><span class="line">    &#125;, </span><br><span class="line">    <span class="string">&quot;changed&quot;</span>: <span class="literal">true</span>, </span><br><span class="line">    <span class="string">&quot;dump&quot;</span>: <span class="string">&quot;0&quot;</span>, </span><br><span class="line">    <span class="string">&quot;fstab&quot;</span>: <span class="string">&quot;/etc/fstab&quot;</span>, </span><br><span class="line">    <span class="string">&quot;fstype&quot;</span>: <span class="string">&quot;nfs&quot;</span>, </span><br><span class="line">    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;/opt&quot;</span>, </span><br><span class="line">    <span class="string">&quot;opts&quot;</span>: <span class="string">&quot;defaults,noatime&quot;</span>, </span><br><span class="line">    <span class="string">&quot;passno&quot;</span>: <span class="string">&quot;0&quot;</span>, </span><br><span class="line">    <span class="string">&quot;src&quot;</span>: <span class="string">&quot;192.168.88.161:/data&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">192.168.88.162 | CHANGED =&gt; &#123;</span><br><span class="line">    <span class="string">&quot;ansible_facts&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;discovered_interpreter_python&quot;</span>: <span class="string">&quot;/usr/bin/python&quot;</span></span><br><span class="line">    &#125;, </span><br><span class="line">    <span class="string">&quot;changed&quot;</span>: <span class="literal">true</span>, </span><br><span class="line">    <span class="string">&quot;dump&quot;</span>: <span class="string">&quot;0&quot;</span>, </span><br><span class="line">    <span class="string">&quot;fstab&quot;</span>: <span class="string">&quot;/etc/fstab&quot;</span>, </span><br><span class="line">    <span class="string">&quot;fstype&quot;</span>: <span class="string">&quot;nfs&quot;</span>, </span><br><span class="line">    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;/opt&quot;</span>, </span><br><span class="line">    <span class="string">&quot;opts&quot;</span>: <span class="string">&quot;defaults,noatime&quot;</span>, </span><br><span class="line">    <span class="string">&quot;passno&quot;</span>: <span class="string">&quot;0&quot;</span>, </span><br><span class="line">    <span class="string">&quot;src&quot;</span>: <span class="string">&quot;192.168.88.161:/data&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="get-url模块"><a href="#get-url模块" class="headerlink" title="get_url模块"></a>get_url模块</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[root@node2 ~]<span class="comment"># ll /tmp/</span></span><br><span class="line">总用量 24</span><br><span class="line">-rw-r--r-- 1 root root     6 8月  20 17:40 a.txt</span><br><span class="line">-rw-rw-rw- 1 root root 20124 8月  20 20:22 remi-release-6.rpm</span><br><span class="line">11).get_url模块，下载模块</span><br><span class="line">下载模块: get_url:</span><br><span class="line">    url：下载地址</span><br><span class="line">    dest： 下载到本地的路径；</span><br><span class="line">    mode:权限;</span><br><span class="line">    checksum：对资源做校验；</span><br><span class="line">    sha256:</span><br><span class="line">    md5:</span><br><span class="line"></span><br><span class="line">例子：</span><br><span class="line">管理端：192.168.88.161</span><br><span class="line">[root@node1 ~]<span class="comment"># ansible test -m get_url -a &#x27;url=http://rpms.famillecollet.com/enterprise/remi-release-6.rpm dest=/tmp mode=0666&#x27;</span></span><br><span class="line"></span><br><span class="line">被管理端：192.168.88.162</span><br><span class="line">[root@node2 ~]<span class="comment"># ll /tmp/</span></span><br><span class="line">总用量 24</span><br><span class="line">-rw-r--r-- 1 root root     6 8月  20 17:40 a.txt</span><br><span class="line">-rw-rw-rw- 1 root root 20124 8月  20 20:22 remi-release-6.rpm</span><br></pre></td></tr></table></figure>

<h3 id="systemd模块"><a href="#systemd模块" class="headerlink" title="systemd模块"></a>systemd模块</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">12).systemd模块，通过systemd来管理服务启停，类似systemctl start httpd</span><br><span class="line">解释：</span><br><span class="line">    name 						服务名称</span><br><span class="line">    state 						服务状态</span><br><span class="line">    started 					启动</span><br><span class="line">    stopped 					停止</span><br><span class="line">    restarted 					重启</span><br><span class="line">    reloaded 					重载</span><br><span class="line">    enabled 					开启自启动| <span class="built_in">yes</span> 启 no 不</span><br><span class="line">    daemon_reload: <span class="built_in">yes</span> 			重载systemd整个的配置文件</span><br><span class="line"></span><br><span class="line">例子:用systemd模块启动或停止服务,加入开机自启动或关闭开机自启</span><br><span class="line">管理端：192.168.88.161</span><br><span class="line"> <span class="comment">#先用别的命令,远程批量安装httpd</span></span><br><span class="line">[root@localhost ~]<span class="comment"># ansible test -m command -a &#x27;yum -y install httpd&quot;</span></span><br><span class="line"><span class="comment">#查看,刚安装的服务并未启动</span></span><br><span class="line">[root@localhost ~]<span class="comment"># ansible test -m command -a &#x27;systemctl status httpd&#x27; </span></span><br><span class="line">192.168.88.162 | FAILED | rc=3 &gt;&gt;</span><br><span class="line">● httpd.service - The Apache HTTP Server</span><br><span class="line">   Loaded: loaded (/usr/lib/systemd/system/httpd.service; enabled; vendor preset: disabled)</span><br><span class="line">   Active: inactive (dead) since 日 2023-08-20 20:33:53 CST; 1min 1s ago</span><br><span class="line">     Docs: man:httpd(8)</span><br><span class="line">           man:apachectl(8)</span><br><span class="line">           </span><br><span class="line">192.168.88.163 | FAILED | rc=3 &gt;&gt;</span><br><span class="line">● httpd.service - The Apache HTTP Server</span><br><span class="line">   Loaded: loaded (/usr/lib/systemd/system/httpd.service; disabled; vendor preset: disabled)</span><br><span class="line">   Active: inactive (dead)</span><br><span class="line">     Docs: man:httpd(8)</span><br><span class="line">           man:apachectl(8)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用systemd模块启动服务并加入开机自启</span></span><br><span class="line">[root@node1 ~]<span class="comment"># ansible test -m systemd -a &#x27;name=httpd state=started enabled=yes&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用systemd模块关闭服务并取消开机自启</span></span><br><span class="line">[root@node1 ~]<span class="comment"># ansible test -m systemd -a &#x27;name=httpd state=stopped enabled=on&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="selinux模块"><a href="#selinux模块" class="headerlink" title="selinux模块"></a>selinux模块</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">13).selinux模块,控制selinux开启或关闭</span><br><span class="line">- name: Enable SELinux</span><br><span class="line">selinux:</span><br><span class="line">policy: targeted</span><br><span class="line">state: disabled</span><br><span class="line"></span><br><span class="line">管理端：192.168.88.161</span><br><span class="line">[root@node1 ~]<span class="comment"># ansible test -m command -a &#x27;getenforce&#x27;  # 先远程查看被管理端得selinux是否开着</span></span><br><span class="line">192.168.88.163 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line">Enforcing   <span class="comment"># 表示开着</span></span><br><span class="line">192.168.88.162 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line">Enforcing</span><br><span class="line"></span><br><span class="line">管理端：192.168.88.161</span><br><span class="line"><span class="comment"># 远程关闭被管理端selinux</span></span><br><span class="line">[root@node1 ~]<span class="comment"># ansible test -m selinux -a &#x27;state=disabled&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="playbook"><a href="#playbook" class="headerlink" title="playbook"></a>playbook</h1><h2 id="playbook相关介绍"><a href="#playbook相关介绍" class="headerlink" title="playbook相关介绍"></a>playbook相关介绍</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1).playbook是一个由yml语法编写的文本文件,它由play和task两部分组成。play:主要定义要操作主机或者主机组task:主要定义对主机或主机组具体执行的任务,可以是一个任务,也可以是多个任务(模块)</span><br><span class="line"></span><br><span class="line">2).playbook是由一个或多个模块组成的,使用多个不同的模块,共同完成一件事情。Playbook通过yaml语法识别描述的状态文件,扩展名是yaml.</span><br></pre></td></tr></table></figure>

<h2 id="yaml三板斧"><a href="#yaml三板斧" class="headerlink" title="yaml三板斧"></a>yaml三板斧</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1).缩进：yaml使用一个固定的缩进风格表示层级结构,每个缩进由两个空格组成,不能使用tab键。</span><br><span class="line">2).冒号：以冒号结尾的除外,其他所有冒号后面所有必须有空格。</span><br><span class="line">3).短横线：表示列表项，使用一个短横线加一个空格作为一个列表项，多个项使用同样的缩进级别作为同一列表。</span><br></pre></td></tr></table></figure>

<h2 id="ansible-playbook得实战案例"><a href="#ansible-playbook得实战案例" class="headerlink" title="ansible-playbook得实战案例"></a>ansible-playbook得实战案例</h2><h3 id="案例1-用ansible-playbook方式远程批量安装httpd-若修改完配置"><a href="#案例1-用ansible-playbook方式远程批量安装httpd-若修改完配置" class="headerlink" title="案例1: 用ansible-playbook方式远程批量安装httpd-若修改完配置"></a>案例1: 用ansible-playbook方式远程批量安装httpd-若修改完配置</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">案例1: 用ansible-playbook方式远程批量安装httpd-若修改完配置,重新推送后,配置改了但没重载服务,不生效</span><br><span class="line"></span><br><span class="line">管理端：192.168.88.161</span><br><span class="line">[root@localhost ~]<span class="comment"># ls</span></span><br><span class="line">httpd.conf httpd_install.yaml</span><br><span class="line">[root@localhost ~]<span class="comment"># vim httpd_install.yaml</span></span><br><span class="line"><span class="comment">#这是一个ansible的playbook</span></span><br><span class="line"><span class="comment">#第一步:找到谁,hosts:定义主机清单,ansible的hosts文件里定义的主机清单模块名</span></span><br><span class="line"><span class="comment">#第二步:大概做的任务:安装,配置,启动</span></span><br><span class="line"><span class="comment">#第三步：具体怎么做</span></span><br><span class="line"><span class="comment">#name：描述信息，task里有3个同级别的列表步骤</span></span><br><span class="line"><span class="comment">#yum: 远端安装服务,yum模块安装服务(installed)</span></span><br><span class="line"><span class="comment">#copy： 远端拷贝文件，copy模块传送文件到远端</span></span><br><span class="line"><span class="comment">#service:远端启动服务(started)#remote_user: root 是指定远程主机上使用的用户</span></span><br><span class="line"><span class="comment">#gather_facts: no是默认执行playbook时候,默认会收集目标主机的信息,禁用掉能提高效率</span></span><br><span class="line">- hosts: <span class="built_in">test</span>		<span class="comment"># 组名</span></span><br><span class="line">  remote_user: root		<span class="comment"># 用户</span></span><br><span class="line">  gather_facts: no </span><br><span class="line">  <span class="comment"># tasks（任务）是一个必要的部分。它定义了在执行Playbook时需要完成的具体操作步骤。每个任务由一个或多个模块组成，这些模块用于执行特定的操作。在Playbook中按顺序列出的任务将按照顺序依次执行。</span></span><br><span class="line">  tasks:</span><br><span class="line">    - name: install httpd fuwu </span><br><span class="line">      yum: name=httpd,httpd-tools state=installed</span><br><span class="line">    - name: configure httpd fuwu </span><br><span class="line">      copy: src=/root/httpd.conf dest=/etc/httpd/conf/httpd.conf</span><br><span class="line">      notify: Restart httpd fuwu</span><br><span class="line">    - name: qidong httpd fuwu</span><br><span class="line">      service: name=httpd state=started enabled=<span class="built_in">yes</span></span><br><span class="line">   <span class="comment"># handlers（处理程序）是一种特殊类型的任务，它定义了在Playbook中需要根据需要触发执行的操作</span></span><br><span class="line">   handlers:</span><br><span class="line">    - name: Restart httpd fuwu</span><br><span class="line">      service: name=httpd state=restarted</span><br><span class="line">      </span><br><span class="line">删除服务器    </span><br><span class="line"><span class="comment">#这是一个ansible的playbook</span></span><br><span class="line"><span class="comment">#第一步:找到谁,hosts:定义主机清单,ansible的hosts文件里定义的主机清单模块名</span></span><br><span class="line"><span class="comment">#第二步:大概做的任务:安装,配置,启动</span></span><br><span class="line"><span class="comment">#第三步:具体怎么做#name:描述信息,task里有3个同级别的列表步骤</span></span><br><span class="line"><span class="comment">#yum:远端安装服务，yum模块安装服务远端拷贝文件，copy模块传送文件到远端</span></span><br><span class="line"><span class="comment">#notify:当该项中的配置文件内容有变更时候,会触发下而的handlers的重启操作(根据handler描述信息关联触发)</span></span><br><span class="line"><span class="comment">#handler:当被触发后执行的操作,重启httpd服务#copy:#service：远端启动服务</span></span><br><span class="line"><span class="comment">#remote user:指定远程主机上使用的用户</span></span><br><span class="line"><span class="comment">#gather_facts：默认执行playbook时候，默认会收集目标主机的信息，禁用掉能提高效率</span></span><br><span class="line">- hosts: <span class="built_in">test</span></span><br><span class="line">  remote_user: root</span><br><span class="line">  gather_facts: no</span><br><span class="line">  tasks:</span><br><span class="line">    - name: remove httpd fufu </span><br><span class="line">      yum: name=httpd,httpd-tools state=absent</span><br><span class="line">    - name: remove apache user</span><br><span class="line">      user: name=apache state=absent</span><br><span class="line">    - name: remove data file</span><br><span class="line">      file: name=/etc/httpd state=absent</span><br></pre></td></tr></table></figure>

<h3 id="案例2：-在管理端安装nfs服务，在被管理端批量挂载nfs的共享目录"><a href="#案例2：-在管理端安装nfs服务，在被管理端批量挂载nfs的共享目录" class="headerlink" title="案例2： 在管理端安装nfs服务，在被管理端批量挂载nfs的共享目录"></a>案例2： 在管理端安装nfs服务，在被管理端批量挂载nfs的共享目录</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># cat /etc/ansible/hosts </span></span><br><span class="line">[<span class="built_in">test</span>]				<span class="comment">#添加一个组名</span></span><br><span class="line">192.168.88.163		<span class="comment">#添加被管理主机的IP</span></span><br><span class="line">192.168.88.162		<span class="comment">#添加被管理主机的IP</span></span><br><span class="line">[root@localhost ~]<span class="comment"># yum-y install nfs-utils		#管理端和被管理的挂载端都要安装,才能挂载</span></span><br><span class="line">[root@localhost ~]<span class="comment"># vim /etc/exports</span></span><br><span class="line">/data *(rw,no_root_squash)</span><br><span class="line">[root@localhost ~]<span class="comment"># ls /data/</span></span><br><span class="line">a.txt</span><br><span class="line">[root@localhost ~]<span class="comment"># cat /data/a.txt</span></span><br><span class="line">111</span><br><span class="line">[root@localhost ~]<span class="comment"># systemctl start nfs</span></span><br><span class="line">[root@localhost ~]<span class="comment"># cat web_mount.yaml</span></span><br><span class="line"><span class="comment">#test: 为/etc/ansible/hosts中的主机列表 #task： 执行的任务</span></span><br><span class="line"><span class="comment">#name：描述信息#mount: mount模块</span></span><br><span class="line"><span class="comment">#state=mounted:马上直接挂载设备，并将配置写入/etc/fstab</span></span><br><span class="line"><span class="comment">#remote_user: root是指定远程主机上使用的用户</span></span><br><span class="line"><span class="comment">#gather_facts: no是默认执行playbook时候,默认会收集目标主机的信息,禁用掉能提高效率</span></span><br><span class="line">- hosts: <span class="built_in">test</span></span><br><span class="line">  remote_user: root</span><br><span class="line">  gather_facts: no</span><br><span class="line">  tasks:</span><br><span class="line">   - name: Mount nfs server share data </span><br><span class="line">     mount: src=192.168.171.128:/data path=/data fstype=nfs opts=defaults state=mounted</span><br><span class="line"><span class="comment">#若将state=absent,则立刻卸载并清除/etc/fstab中信息</span></span><br></pre></td></tr></table></figure>

<h3 id="案例3：远程批量安装源码nginx服务"><a href="#案例3：远程批量安装源码nginx服务" class="headerlink" title="案例3：远程批量安装源码nginx服务"></a>案例3：远程批量安装源码nginx服务</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#test:为/etc/ansible/hosts中的主机列表		 #task:执行的任务</span></span><br><span class="line"><span class="comment">#name：描述信息							  #yum: yum模块，安装服务的</span></span><br><span class="line"><span class="comment">#copy: copy模块,远程传递文件的				#file： file模块，远程创建目录的</span></span><br><span class="line"><span class="comment">#service: service模块,远程管理服务的</span></span><br><span class="line"><span class="comment">#remote_user: root是指定远程主机上使用的用户</span></span><br><span class="line"><span class="comment">#gather_facts: no是默认执行playbook时候,默认会收集目标主机的信息,禁用掉能提高效率</span></span><br><span class="line"><span class="comment">#使用前先将相关软件包: nginx压缩包和jdk压缩包上传到/root/ansible-playbook-deploy-nginx/目录中</span></span><br><span class="line">- hosts: <span class="built_in">test</span></span><br><span class="line">  remote_user: root</span><br><span class="line">  gather_facts: no</span><br><span class="line">  vars:</span><br><span class="line">    src_nginx: /root/nginx-1.13.7.tar.gz</span><br><span class="line">    nginx_jieya_dir: /usr/local</span><br><span class="line">    nginx_install_dir: /usr/local/nginx</span><br><span class="line">    nginx_jieyahou_name: nginx-1.13.7</span><br><span class="line"></span><br><span class="line">  tasks:</span><br><span class="line"><span class="comment">#上传nginx压缩安装包到: /root/ansible-playbook-deploy-nginx/,提前操作</span></span><br><span class="line"><span class="comment">#安装编译工具和相关依赖</span></span><br><span class="line"><span class="comment">#- name: Install gcc gcc-c++ and yilai</span></span><br><span class="line"><span class="comment"># yum: name=&#123;&#123; item &#125;&#125; state=installed</span></span><br><span class="line"><span class="comment"># with_items:</span></span><br><span class="line"><span class="comment">#   - gcc</span></span><br><span class="line"><span class="comment">#   - gcc-c++</span></span><br><span class="line"><span class="comment">#   - openssl-devel</span></span><br><span class="line"><span class="comment">#   - openssl</span></span><br><span class="line"><span class="comment">#   - zlib</span></span><br><span class="line"><span class="comment">#   - zlib-devel</span></span><br><span class="line"><span class="comment">#   - pcre</span></span><br><span class="line"><span class="comment">#   - pcre-devel</span></span><br><span class="line"><span class="comment">#注意：下面yum安装依赖方式也可用上面方式安装</span></span><br><span class="line"><span class="comment">#安装编译工具和相关依赖</span></span><br><span class="line">    - name: Install gcc gcc-c++ and yilai</span><br><span class="line">      yum:</span><br><span class="line">        name: <span class="string">&quot;gcc,gcc-c++,openssl-devel,openssl,zlib,zlib-devel,pcre,pcre-devel,vim,wget&quot;</span></span><br><span class="line">        state: installed</span><br><span class="line"><span class="comment">#解压nginx压缩包</span></span><br><span class="line">    - name: Unarchive nginx package</span><br><span class="line">      unarchive:</span><br><span class="line">        src: <span class="string">&quot;&#123;&#123; src_nginx &#125;&#125;&quot;</span></span><br><span class="line">        dest: <span class="string">&quot;&#123;&#123; nginx_jieya_dir &#125;&#125;&quot;</span></span><br><span class="line"><span class="comment"># 配置编译nginx</span></span><br><span class="line">    - name: Config and bianyi nginx</span><br><span class="line">      shell: |</span><br><span class="line">        useradd -s /sbin/nologin nginx</span><br><span class="line">        <span class="built_in">cd</span> &#123;&#123; nginx_jieya_dir &#125;&#125;/&#123;&#123; nginx_jieyahou_name &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#./configure 是运行 Nginx 的配置脚本。</span></span><br><span class="line"><span class="comment">#--user=nginx 指定运行 Nginx 进程的用户为 nginx 用户。</span></span><br><span class="line"><span class="comment">#--group=nginx 指定运行 Nginx 进程的用户组为 nginx 组。</span></span><br><span class="line"><span class="comment">#--prefix=&#123;&#123; nginx_install_dir &#125;&#125; 指定安装 Nginx 的目录为 &#123;&#123; nginx_install_dir &#125;&#125;。</span></span><br><span class="line"><span class="comment">#--with-http_stub_status_module 启用 Nginx 的 HTTP status 模块，用于获取服务器状态信息。</span></span><br><span class="line"><span class="comment">#--with-http_ssl_module 启用 Nginx 的 SSL 模块，支持通过 HTTPS 访问。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#make 命令用于编译 Nginx 源代码。</span></span><br><span class="line"><span class="comment">#make install 命令用于将编译好的 Nginx 可执行文件和相关文件安装到指定目录中，即 &#123;&#123; nginx_install_dir &#125;&#125;。</span></span><br><span class="line">        ./configure --user=nginx --group=nginx --prefix=&#123;&#123; nginx_install_dir &#125;&#125; --with-http_stub_status_module --with-http_ssl_module</span><br><span class="line">        make</span><br><span class="line">        make install</span><br><span class="line"></span><br><span class="line">    - name: Start nginx</span><br><span class="line">      shell: /usr/local/nginx/sbin/nginx</span><br><span class="line"></span><br><span class="line"><span class="comment">#注意上面解压也可用另一种方式: shell命令</span></span><br><span class="line"><span class="comment"># - name: Unarchive tomcat package</span></span><br><span class="line"><span class="comment">#   copy: src=/root/ansible-playbook-deploy-tomcat/apache-tomcat-8.0.32.tar.gz dest=/tmp/</span></span><br><span class="line"><span class="comment"># - name: Unarchive tomcat</span></span><br><span class="line"><span class="comment">#   shell: cd /tmp &amp;&amp; tar -zxf apache-tomcat-8.0.32.tar.gzxxxxxxxxxx </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">没注释的</span><br><span class="line">- hosts: <span class="built_in">test</span></span><br><span class="line">  remote_user: root</span><br><span class="line">  gather_facts: no</span><br><span class="line">  vars:</span><br><span class="line">    src_nginx: /root/nginx-1.13.7.tar.gz</span><br><span class="line">    nginx_jieya_dir: /usr/local</span><br><span class="line">    nginx_install_dir: /usr/local/nginx</span><br><span class="line">    nginx_jieyahou_name: nginx-1.13.7</span><br><span class="line"></span><br><span class="line">  tasks:</span><br><span class="line">    - name: Install gcc gcc-c++ and yilai</span><br><span class="line">      yum:</span><br><span class="line">        name: <span class="string">&quot;gcc,gcc-c++,openssl-devel,openssl,zlib,zlib-devel,pcre,pcre-devel,vim,wget&quot;</span></span><br><span class="line">        state: installed</span><br><span class="line"></span><br><span class="line">    - name: Unarchive nginx package</span><br><span class="line">      unarchive:</span><br><span class="line">        src: <span class="string">&quot;&#123;&#123; src_nginx &#125;&#125;&quot;</span></span><br><span class="line">        dest: <span class="string">&quot;&#123;&#123; nginx_jieya_dir &#125;&#125;&quot;</span></span><br><span class="line"></span><br><span class="line">    - name: Config and bianyi nginx</span><br><span class="line">      shell: |</span><br><span class="line">        useradd -s /sbin/nologin nginx</span><br><span class="line">        <span class="built_in">cd</span> &#123;&#123; nginx_jieya_dir &#125;&#125;/&#123;&#123; nginx_jieyahou_name &#125;&#125;</span><br><span class="line">        ./configure --user=nginx --group=nginx --prefix=&#123;&#123; nginx_install_dir &#125;&#125; --with-http_stub_status_module --with-http_ssl_module</span><br><span class="line">        make</span><br><span class="line">        make install</span><br><span class="line"></span><br><span class="line">    - name: Start nginx</span><br><span class="line">      shell: /usr/local/nginx/sbin/nginx</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="案例4：远程批量安装二进制tomcat服务"><a href="#案例4：远程批量安装二进制tomcat服务" class="headerlink" title="案例4：远程批量安装二进制tomcat服务"></a>案例4：远程批量安装二进制tomcat服务</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#test: 为/etc/ansible/hosts中的主机列表 #task:执行的任务</span></span><br><span class="line"><span class="comment">#name：描述信息#yum: yum模块，安装服务的</span></span><br><span class="line"><span class="comment">#copy: copy模块,远程传递文件的#file： file模块，远程创建目录的</span></span><br><span class="line"><span class="comment">#service: service模块,远程管理服务的</span></span><br><span class="line"><span class="comment">#remote_user: root是指定远程主机上使用的用户</span></span><br><span class="line"><span class="comment">#gather_facts: no是默认执行playbook时候,默认会收集目标主机的信息,禁用掉能提高效率</span></span><br><span class="line"><span class="comment">#使用前先将相关软件包: tomcat压缩包和jdk压缩包上传到/root/ansible-playbook-deploy-tomcat/目录中</span></span><br><span class="line">- hosts: <span class="built_in">test</span></span><br><span class="line">  remote_user: root</span><br><span class="line">  gather_facts: no</span><br><span class="line">  vars:</span><br><span class="line">    src_jdk: /root/ansible-playbook-deploy-tomcat/jdk-8u65-linux-x64.gz</span><br><span class="line">    jdk_install_dir: /usr/local</span><br><span class="line">    jdk_jieyahou_name: jdk1.8.0_65</span><br><span class="line">    src_tomcat: /root/ansible-playbook-deploy-tomcat/apache-tomcat-8.0.32.tar.gz</span><br><span class="line">    tomcat_install_dir: /usr/local</span><br><span class="line">    tomcat_jieyahou_name: apache-tomcat-8.0.32</span><br><span class="line"></span><br><span class="line">  tasks:</span><br><span class="line">  <span class="comment">#上传jdk压缩安装包到: /root/ansible-playbook-deploy-tomcat/,提前操作</span></span><br><span class="line">  <span class="comment">#解压jdk压缩包</span></span><br><span class="line">    - name: Unarchive JDK package</span><br><span class="line">      unarchive:</span><br><span class="line">        src: <span class="string">&quot;&#123;&#123; src_jdk &#125;&#125;&quot;</span></span><br><span class="line">        dest: <span class="string">&quot;&#123;&#123; jdk_install_dir &#125;&#125;&quot;</span></span><br><span class="line">   <span class="comment">#配置jdk环境变量</span></span><br><span class="line">   - name: <span class="built_in">set</span> jdk global <span class="built_in">env</span></span><br><span class="line">     shell: <span class="built_in">echo</span> <span class="string">&quot;export JAVA_HOME=/usr/local/&#123;&#123; jdk_jieyahou_name &#125;&#125;&quot;</span> &gt;&gt; ~/.bashrc &amp;&amp;              <span class="built_in">echo</span> <span class="string">&quot;&quot;</span><span class="built_in">export</span> PATH=<span class="variable">$JAVA_HOME</span>/bin:<span class="variable">$PATH</span><span class="string">&quot;&quot;</span> &gt;&gt; ~/.bashrc &amp;&amp; </span><br><span class="line">           <span class="built_in">echo</span> <span class="string">&quot;export CLASSPATH=.:<span class="variable">$JAVA_HOME</span>/lib/dt.jar:<span class="variable">$JAVA_HOME</span>/lib/tools.jar&quot;</span> &gt;&gt; ~/.bashrc &amp;&amp;</span><br><span class="line">           <span class="built_in">source</span> ~/.bashrc </span><br><span class="line">    <span class="comment">#有yum源时jdk也可采用下面方式安装</span></span><br><span class="line">    <span class="comment">#安装jdk环境</span></span><br><span class="line">    <span class="comment">#- name: Install jdk1.8yum: name=java-1.8.0-openjdk state=installed</span></span><br><span class="line">    <span class="comment">#上传tomcat软件包到/root/ansible-playbook-deploy-tomcat/目录,提前操作</span></span><br><span class="line">    <span class="comment">#解压tomcat软件包  </span></span><br><span class="line">    - name: Unarchive tomcat package </span><br><span class="line">      unarchive: </span><br><span class="line">       src: <span class="string">&quot;&#123;&#123; src_tomcat &#125;&#125;&quot;</span> </span><br><span class="line">       dest: <span class="string">&quot;&#123;&#123; tomcat_install_dir &#125;&#125;&quot;</span></span><br><span class="line">    <span class="comment">#start tomcat,注意: tomcat首次启动需要用 nohup ./startup.sh &amp; 或 nohup ./catalina.sh &amp; 启动,如果直接使用/.../.../tomcat.../bin/startup.sh则启动不了</span></span><br><span class="line">    - name: Start tomcat</span><br><span class="line">      shell: <span class="built_in">cd</span> <span class="string">&quot;&#123;&#123; tomcat_install_dir &#125;&#125;&quot;</span> &amp;&amp; <span class="built_in">cd</span> <span class="string">&quot;&#123;&#123; tomcat_jieyahou_name &#125;&#125;&quot;</span>/bin &amp;&amp; <span class="built_in">nohup</span> ./startup.sh &amp;</span><br><span class="line">    <span class="comment">#注意上面解压也可用另一种方式: shell命令</span></span><br><span class="line">    <span class="comment">#- name: Unarchive tomcat package</span></span><br><span class="line">    <span class="comment"># copy: src=/root/ansible-playbook-deploy-tomcat/apache-tomcat-8.0.32.tar.gz dest=/tmp/</span></span><br><span class="line">    <span class="comment">#- name: Unarchive tomcat</span></span><br><span class="line">    <span class="comment"># shell: cd /tmp &amp;&amp; tar-zxf apache-tomcat-8.0.32.tar.gz</span></span><br></pre></td></tr></table></figure>







<div class="note orange icon-padding flat"><i class="note-icon fas fa-battery-half"></i><p>该文章湫日所著，如有错误请联系作者更改</p>
</div></article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Linux/">Linux</a><a class="post-meta__tags" href="/tags/%E7%BC%96%E7%A8%8B/">编程</a><a class="post-meta__tags" href="/tags/Ansible/">Ansible</a></div><div class="post_share"><div class="social-share" data-image="https://www.extremetech.com/wp-content/uploads/2012/05/Linux-logo-without-version-number-banner-sized.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="/img/wechat.jpg" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="/img/alipay.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/06/30/%E5%AE%9D%E5%A1%94%E5%BC%80%E5%BF%83%E4%BC%81%E4%B8%9A%E7%89%88%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/" title="宝塔开心企业版安装教程"><img class="cover" src="https://www.extremetech.com/wp-content/uploads/2012/05/Linux-logo-without-version-number-banner-sized.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">宝塔开心企业版安装教程</div></div></a></div><div class="next-post pull-right"><a href="/2023/08/22/Linux-Azkaban%E5%AE%89%E8%A3%85/" title="Linux-Azkaban3.50.0安装"><img class="cover" src="https://www.extremetech.com/wp-content/uploads/2012/05/Linux-logo-without-version-number-banner-sized.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Linux-Azkaban3.50.0安装</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2023/08/22/Linux-Azkaban%E5%AE%89%E8%A3%85/" title="Linux-Azkaban3.50.0安装"><img class="cover" src="https://www.extremetech.com/wp-content/uploads/2012/05/Linux-logo-without-version-number-banner-sized.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-08-22</div><div class="title">Linux-Azkaban3.50.0安装</div></div></a></div><div><a href="/2023/08/21/Linux-Flume%E5%AE%89%E8%A3%85/" title="Linux-Flume1.8.0安装"><img class="cover" src="https://www.extremetech.com/wp-content/uploads/2012/05/Linux-logo-without-version-number-banner-sized.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-08-21</div><div class="title">Linux-Flume1.8.0安装</div></div></a></div><div><a href="/2023/07/14/Linux-Hadoop%E5%AE%89%E8%A3%85%E6%AD%A5%E9%AA%A4/" title="Linux-Hadoop2.7.4安装步骤"><img class="cover" src="https://www.extremetech.com/wp-content/uploads/2012/05/Linux-logo-without-version-number-banner-sized.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-07-14</div><div class="title">Linux-Hadoop2.7.4安装步骤</div></div></a></div><div><a href="/2023/07/13/Linux-Zabbix%E5%AE%89%E8%A3%85/" title="Linux-Zabbix安装"><img class="cover" src="https://www.extremetech.com/wp-content/uploads/2012/05/Linux-logo-without-version-number-banner-sized.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-07-13</div><div class="title">Linux-Zabbix安装</div></div></a></div><div><a href="/2023/07/12/Linux-Tomcat%E5%AE%89%E8%A3%85/" title="Linux-Tomcat8.5.88安装"><img class="cover" src="https://www.extremetech.com/wp-content/uploads/2012/05/Linux-logo-without-version-number-banner-sized.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-07-12</div><div class="title">Linux-Tomcat8.5.88安装</div></div></a></div><div><a href="/2023/08/21/Linux-Zookeeper%E5%AE%89%E8%A3%85/" title="Linux-Zookeeper3.4.10安装"><img class="cover" src="https://www.extremetech.com/wp-content/uploads/2012/05/Linux-logo-without-version-number-banner-sized.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-08-21</div><div class="title">Linux-Zookeeper3.4.10安装</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/favicon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Mec</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">13</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">14</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">7</div></a></div><a id="card-info-btn" href="/2023/06/17/hello-world/"><i></i><span>联系作者</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Mec8" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:shop2018@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来到我的博客，投稿请发到邮箱！不懂的欢迎来一起交流！</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#ansible%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%9D%97"><span class="toc-number">1.</span> <span class="toc-text">ansible常用命令模块</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ansible%E7%9A%84%E7%9B%B8%E5%85%B3%E6%A6%82%E5%BF%B5%E5%92%8C%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">2.</span> <span class="toc-text">ansible的相关概念和使用场景</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ansible%E7%9A%84%E4%B8%BB%E8%A6%81%E5%8A%9F%E8%83%BD"><span class="toc-number">3.</span> <span class="toc-text">ansible的主要功能</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ansible%E7%9A%84%E7%89%B9%E7%82%B9"><span class="toc-number">4.</span> <span class="toc-text">ansible的特点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ansible%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">5.</span> <span class="toc-text">ansible的配置文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ansible%E7%9A%84%E5%AE%89%E8%A3%85%E6%96%B9%E5%BC%8F"><span class="toc-number">6.</span> <span class="toc-text">ansible的安装方式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ansible%E7%9A%84%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE"><span class="toc-number">7.</span> <span class="toc-text">ansible的基本配置</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ansible%E5%91%BD%E4%BB%A4%E7%9A%84%E5%B8%B8%E7%94%A8%E6%A8%A1%E5%9D%97%E4%BD%BF%E7%94%A8-ad-hoc%E6%A8%A1%E5%BC%8F-%E6%89%B9%E9%87%8F%E6%93%8D%E4%BD%9C%E5%AE%9E%E6%88%98"><span class="toc-number"></span> <span class="toc-text">ansible命令的常用模块使用-ad-hoc模式-批量操作实战</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ansible%E7%9A%84ad-hoc%E6%A8%A1%E5%BC%8F%E6%88%96%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F%E7%AE%80%E4%BB%8B"><span class="toc-number">1.</span> <span class="toc-text">ansible的ad-hoc模式或命令模式简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ansible%E5%B8%B8%E7%94%A8%E7%9A%84%E6%A8%A1%E5%9D%97%E4%BD%BF%E7%94%A8-%E9%80%9A%E8%BF%87ad-hoc%E5%91%BD%E4%BB%A4%E8%A1%8C%E4%BD%BF%E7%94%A8"><span class="toc-number">2.</span> <span class="toc-text">ansible常用的模块使用-通过ad-hoc命令行使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#command%E6%88%96shell%E6%A8%A1%E5%9D%97"><span class="toc-number">2.1.</span> <span class="toc-text">command或shell模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#copy%E6%A8%A1%E5%9D%97"><span class="toc-number">2.2.</span> <span class="toc-text">copy模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#yun%E6%A8%A1%E5%9D%97"><span class="toc-number">2.3.</span> <span class="toc-text">yun模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#service%E6%A8%A1%E5%9D%97"><span class="toc-number">2.4.</span> <span class="toc-text">service模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#script%E6%A8%A1%E5%9D%97"><span class="toc-number">2.5.</span> <span class="toc-text">script模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#file%E6%A8%A1%E5%9D%97"><span class="toc-number">2.6.</span> <span class="toc-text">file模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#group%E6%A8%A1%E5%9D%97"><span class="toc-number">2.7.</span> <span class="toc-text">group模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#user%E6%A8%A1%E5%9D%97"><span class="toc-number">2.8.</span> <span class="toc-text">user模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#cron%E6%A8%A1%E5%9D%97"><span class="toc-number">2.9.</span> <span class="toc-text">cron模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mount%E6%A8%A1%E5%9D%97"><span class="toc-number">2.10.</span> <span class="toc-text">mount模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#get-url%E6%A8%A1%E5%9D%97"><span class="toc-number">2.11.</span> <span class="toc-text">get_url模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#systemd%E6%A8%A1%E5%9D%97"><span class="toc-number">2.12.</span> <span class="toc-text">systemd模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#selinux%E6%A8%A1%E5%9D%97"><span class="toc-number">2.13.</span> <span class="toc-text">selinux模块</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#playbook"><span class="toc-number"></span> <span class="toc-text">playbook</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#playbook%E7%9B%B8%E5%85%B3%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.</span> <span class="toc-text">playbook相关介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#yaml%E4%B8%89%E6%9D%BF%E6%96%A7"><span class="toc-number">2.</span> <span class="toc-text">yaml三板斧</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ansible-playbook%E5%BE%97%E5%AE%9E%E6%88%98%E6%A1%88%E4%BE%8B"><span class="toc-number">3.</span> <span class="toc-text">ansible-playbook得实战案例</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B1-%E7%94%A8ansible-playbook%E6%96%B9%E5%BC%8F%E8%BF%9C%E7%A8%8B%E6%89%B9%E9%87%8F%E5%AE%89%E8%A3%85httpd-%E8%8B%A5%E4%BF%AE%E6%94%B9%E5%AE%8C%E9%85%8D%E7%BD%AE"><span class="toc-number">3.1.</span> <span class="toc-text">案例1: 用ansible-playbook方式远程批量安装httpd-若修改完配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B2%EF%BC%9A-%E5%9C%A8%E7%AE%A1%E7%90%86%E7%AB%AF%E5%AE%89%E8%A3%85nfs%E6%9C%8D%E5%8A%A1%EF%BC%8C%E5%9C%A8%E8%A2%AB%E7%AE%A1%E7%90%86%E7%AB%AF%E6%89%B9%E9%87%8F%E6%8C%82%E8%BD%BDnfs%E7%9A%84%E5%85%B1%E4%BA%AB%E7%9B%AE%E5%BD%95"><span class="toc-number">3.2.</span> <span class="toc-text">案例2： 在管理端安装nfs服务，在被管理端批量挂载nfs的共享目录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B3%EF%BC%9A%E8%BF%9C%E7%A8%8B%E6%89%B9%E9%87%8F%E5%AE%89%E8%A3%85%E6%BA%90%E7%A0%81nginx%E6%9C%8D%E5%8A%A1"><span class="toc-number">3.3.</span> <span class="toc-text">案例3：远程批量安装源码nginx服务</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B4%EF%BC%9A%E8%BF%9C%E7%A8%8B%E6%89%B9%E9%87%8F%E5%AE%89%E8%A3%85%E4%BA%8C%E8%BF%9B%E5%88%B6tomcat%E6%9C%8D%E5%8A%A1"><span class="toc-number">3.4.</span> <span class="toc-text">案例4：远程批量安装二进制tomcat服务</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/06/30/%E5%AD%A6%E4%B9%A0%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%EF%BC%88%E4%B8%80%EF%BC%89/" title="学习微信小程序（一）"><img src="https://pic1.zhimg.com/70/v2-8be135fcd63a76563ac76647a1b79f71_1440w.avis?source=172ae18b&amp;biz_tag=Post" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="学习微信小程序（一）"/></a><div class="content"><a class="title" href="/2024/06/30/%E5%AD%A6%E4%B9%A0%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%EF%BC%88%E4%B8%80%EF%BC%89/" title="学习微信小程序（一）">学习微信小程序（一）</a><time datetime="2024-06-30T07:48:44.000Z" title="发表于 2024-06-30 15:48:44">2024-06-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/06/30/%E5%AE%9D%E5%A1%94%E5%BC%80%E5%BF%83%E4%BC%81%E4%B8%9A%E7%89%88%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/" title="宝塔开心企业版安装教程"><img src="https://www.extremetech.com/wp-content/uploads/2012/05/Linux-logo-without-version-number-banner-sized.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="宝塔开心企业版安装教程"/></a><div class="content"><a class="title" href="/2024/06/30/%E5%AE%9D%E5%A1%94%E5%BC%80%E5%BF%83%E4%BC%81%E4%B8%9A%E7%89%88%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/" title="宝塔开心企业版安装教程">宝塔开心企业版安装教程</a><time datetime="2024-06-30T07:46:47.000Z" title="发表于 2024-06-30 15:46:47">2024-06-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/08/24/Ansible%E7%9A%84%E4%BB%8B%E7%BB%8D%E4%B8%8E%E5%AE%89%E8%A3%85/" title="Linux-Ansible的简介与安装-湫日"><img src="https://www.extremetech.com/wp-content/uploads/2012/05/Linux-logo-without-version-number-banner-sized.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Linux-Ansible的简介与安装-湫日"/></a><div class="content"><a class="title" href="/2023/08/24/Ansible%E7%9A%84%E4%BB%8B%E7%BB%8D%E4%B8%8E%E5%AE%89%E8%A3%85/" title="Linux-Ansible的简介与安装-湫日">Linux-Ansible的简介与安装-湫日</a><time datetime="2023-08-24T11:09:42.000Z" title="发表于 2023-08-24 19:09:42">2023-08-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/08/22/Linux-Azkaban%E5%AE%89%E8%A3%85/" title="Linux-Azkaban3.50.0安装"><img src="https://www.extremetech.com/wp-content/uploads/2012/05/Linux-logo-without-version-number-banner-sized.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Linux-Azkaban3.50.0安装"/></a><div class="content"><a class="title" href="/2023/08/22/Linux-Azkaban%E5%AE%89%E8%A3%85/" title="Linux-Azkaban3.50.0安装">Linux-Azkaban3.50.0安装</a><time datetime="2023-08-22T02:17:51.000Z" title="发表于 2023-08-22 10:17:51">2023-08-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/08/21/Linux-Flume%E5%AE%89%E8%A3%85/" title="Linux-Flume1.8.0安装"><img src="https://www.extremetech.com/wp-content/uploads/2012/05/Linux-logo-without-version-number-banner-sized.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Linux-Flume1.8.0安装"/></a><div class="content"><a class="title" href="/2023/08/21/Linux-Flume%E5%AE%89%E8%A3%85/" title="Linux-Flume1.8.0安装">Linux-Flume1.8.0安装</a><time datetime="2023-08-21T12:51:13.000Z" title="发表于 2023-08-21 20:51:13">2023-08-21</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2023 - 2024 By Mec</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">欢迎来到我的博客 我的QQ是2258878405</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="true"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>